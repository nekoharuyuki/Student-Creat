<HTML>
<HEAD>
<TITLE>平成12年度春期試験</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" topmargin="0" leftmargin="0">
<blockquote>
<hr>
<H3 align="center">平成12年度春期試験　正解例と解説(問11～問14)</H3>
<HR WIDTH=100%>  
<a NAME="110">　<BR> 
<b> 
問11</b></a>　
<hr>
<a NAME="111">　<BR>
<b>
設問</b></a><b><a NAME="111">1</a>　</b>
<p>＜解答＞　エ　</p>
<p>＜解説＞<br>
　①の場合，被乗数decAが－123，乗数decBが－4で両方とも符号が‘－’であるため，行番号14～18の処理で，符号signは‘－’にはセットされず，初期値の‘＋’になります。行番号44～45の処理では，sign＝‘－’の場合にだけ乗算結果の符合decC［0］には‘－’がセットされますが，この場合‘＋’であるので，行番号49～51の処理により先頭部分に続く‘0’をスキップし，‘0’でない数字が出現すればbreakして，次のdecCへの格納処理で最上位の数字から格納されていきます。したがって①の場合は492になります。<br>
　②の場合，被乗数decAが＋123，乗数decBが－04で片方だけ符号が‘－’であるため，行番号14～18の処理で，符号signは‘－’にはセットされ，行番号44～45の処理により乗算結果の符合decC［0］には‘－’がセットされます。先頭部分の‘0’はスキップされるので，②の場合は－492になります。<br>
</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#111">問題へ</a>
<HR WIDTH=100%>
<a NAME="112">
<b>
設問</b></a><b>2　</b>
<p>＜解答＞　イ　　</p>
<p>行29を含むif文の処理は，同じ桁位置にある前の演算結果decT［ti］との加算により桁上がりが発生する場合の処理です。234×56の場合，前の演算結果4と同じ桁位置にある7との加算で，桁上がりが1回だけ発生します。</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td>
      <p align="right">234<br>
      <u>×　56</u><br>
      1 4<sup><font color="#FF00FF">2</font></sup>0<sup><font color="#FF00FF">2</font></sup>4<br>    
      11<font color="#FF00FF"><sup>1</sup></font>7<font color="#FF00FF"><sup>2</sup></font>0&nbsp;&nbsp;&nbsp;<br>    
      1 3<font color="#FF00FF"><sup>1</sup></font>104</td>    
  </tr>    
</table>    
<p>　</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#112">問題へ</a>
<HR WIDTH=100%>
<a NAME="113">
<b>
設問</b></a><b><a NAME="111">3</a>　</b>
<p>＜解答＞　ａ　カ　　ｂ　イ　　ｃ　ウ　　ｄ　ウ</p>
<p>＜解説＞空欄ａ，ｂについて<br>
　22行目直前に追加される処理で，乗数decB［bi］に小数点“．”が出現したときbp＝bi＋1にセットされるので，bpには乗数の先頭位置からの小数点位置がセットされることになります。（添字biは0から始まるので＋1します）空欄ａでは，小数点の左へ桁位置を1つ進める処理に該当し，bi--とすればよい。同様に空欄ｂもa--となります。<br>
空欄ｃについて</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td valign="top">①</td>
    <td>空欄ｄを含むループ処理では，配列decT［ti］の最後尾の数字から順に読み込んで，整数第1位よりも先頭部に0が連続するか，あるいは整数第1位よりも先頭部の部分で0以外の数字が出現すればスキップしています。次のforループでは，整数第1位以降の数字をdecT［ti］からdecC［ci］に転送しています。そしてti＝tpのときdecC［ci］に小数点‘．’を転送しています。したがって乗算結果が格納されている配列decTには，decT［tp＋1］に整数第1位の数字が格納され，その直前のdecT［tp］には小数第1位の数字が格納されていることになります。添字は0から始まるのでdecT［tp］からdecT［0］に小数点以下の数字が格納されます。したがって乗算結果については小数点以下の桁数＝tp＋1になります。</td>
  </tr>
  <tr>
    <td valign="top">②</td>
    <td>空欄ａ，ｂの直前で設定されているap，bpは，それぞれ被乗数，乗数の数字の先頭からの小数点位置であり，またam，bmはそれぞれ被乗数，乗数の桁数です。したがって（am－ap），（bm－bp）はそれぞれ被乗数，乗数の小数点以下の桁数になります。これより乗算結果の小数点以下の桁数＝（am－ap）＋（bm－bp）となります。①と②よりtp＋1＝（am－ap）＋（bm－bp）。<br>
したがってtp＝（am－ap）＋（bm－bp）－1になります。<br>
空欄ｄについて<br>
      　ti＝tm－1からtp＋2まで（小数点の左2つ目まで）の数字の先頭部の0はスキップする必要がありますが，0でない数字decT［ti］が出現すればスキップせずdecC［ci］に転送する必要があります。したがって空欄ｄの繰返し条件はti＞tp＋1になります。</td>
  </tr>
</table>
<p>　</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#113">問題へ</a>
<HR WIDTH=100%>
<p><A HREF="index.htm">メニューへ戻る</A>　</p>
<HR WIDTH=100%>
<a NAME="120">　<BR>
<b>
問12</b></a>　　
<HR WIDTH=100%> 
<a NAME="121"><b>　<BR> 
設問</b></a><b>1　</b>
<p>＜解答＞　オ</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td>＜解説＞</td>
  </tr>
</table>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td valign="top">(1)</td>
    <td>プログラムでは商品ごとの販売数量の曜日別合計を、2次元配列H-YOBI(H1 H2)を用いてテーブル集計している。行番号31のREAD文直後の最初のPERFORM文で、売上記録ファイルを読んで、このテーブル集計を行っている。</td>    
  </tr>    
  <tr>    
    <td valign="top">(2)</td>   
    <td>売上記録ファイルがAT ENDとなり集計が終われば、行番号38以降で集計結果の出力処理が行われている。</td>    
  </tr>    
  <tr>    
    <td valign="top">(3)</td>   
    <td>行番号42のPERFORM文のSHUTSURYOKU処理で、集計テーブルの集計結果の出力処理が行われている。</td>   
  </tr>   
</table>   
<p>　商品ごとの販売数量の曜日別合計のための集計用テーブルH-YOBI(H1 H2)で用いられているH1、H2に対して、行番号33, 34のSET文で</p>    
<p>　　① H1に分類コードK-BUNRUIがセットされ<br>    
　　② H2に曜日コードK-YOBIがセットされている</p>    
<p>　出力処理において行番号47のMOVE文で、集計用テーブルM-YOBI(H1 H2)の集計結果が、明細編集のための作業エリアM-SURYO(M1)に転送され編集されている。このM1は行番号25～27で、テーブルM-SURYOの指標としてOCCURS句で6を指定し定義している。つまりこれは1行分の月曜から土曜までの６つの曜日別合計の編集エリアに対応しているものである。したがってM1とH2は曜日コードに対応している。<br>    
　またB1は行番号23で、テーブルM-BUNRUIの指標としてOCCURS句で5を指定し定義している。つまりM-BUNRUI(B1)は5つの分類コードに対応したものである。したがってB1とH1は分類コードに対応している。<br>
</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#121">問題へ</a>
<HR WIDTH=100%>
<a NAME="122"><b>　<BR>
設問</b></a><b>2</b>
<p>＜解答＞　a　ウ　　b　ア　　c　ウ</p>
<p>＜解説＞<b>　</b>　変更後は曜日コードを指定して、商品分類ごとに店舗別に販売数量を集計する。そのため集計用テーブルを3次元配列H-YOBI(H0 H1 H2)に変更し、指標H0を追加している。<br>    
　空欄aの解答群は、SHIJI-X、SHIJI-9に関するデータ名の定義に関するものである。38～43行目の置換部分より、ACCEPT命令で</p>
<p>　　①SHIJI-Xに"Q"を入力すると終了<br>
　　②SHIJI-Xに"1"～"6"を入力すると、集計結果を出力<br>
　　③SHIJI-Xに上記以外を入力すると "TEISEI YOBI" を表示</p>    
<p>する。文字"Q"も入力するのでSHIJI-XはXタイプの文字項目で定義されている。<br>    
②の集計結果の出力処理において、SET H2 TO SHIJI-9により曜日コードを指定する指標H2にSHIJI-9がセットされている。指標H2は、9タイプの数値項目である。SHIJI-9にはSHIJI-Xに入力された"1"～"6"の曜日コードが、数値項目としてセットされている必要がある。これより前にSHIJI-9に数値1～6をセットしている処理がない。したがって解答群のウ、"01 SHIJI-9 REDEFINES SHIJI-X PIC 9."により再定義する必要がある。<br>    
　空欄bは、売上記録ファイルの店舗コードK-MISEをテーブルの指標H0にセットして、対応する集計用テーブルに数量K-SURYOを加算する処理である。したがって解答群のア、H-YOBI(H0 H1 H2)が正解。<br>    
　空欄cは、分類コードH1に対して店舗コードH0を1～3まで変えて、1行ずつ印刷を繰返す処理であり、解答群のウのPERFORM文が正解。<br>
　</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#122">問題へ</a>
<HR WIDTH=100%>
<p>
<A HREF="index.htm">メニューへ戻る</A></p>
<HR WIDTH=100%>
<p>
<a NAME="130">
<b>問13</b></a><b>　　</b>（解説は省略します。）</p>
<HR WIDTH=100%> 
<a NAME="131">　<BR> 
<b> 
設問</b></a><b>1</b>　
<p>＜解答＞　イ</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#131">問題へ</a>
<hr>
<a NAME="132">　<BR> 
<b> 
設問</b></a><b>2</b>　
<p>＜解答＞　a　カ　　　b　エ　　　c　エ</p>
<HR WIDTH=100%>
<a HREF="12s_p_e4.htm#132">問題へ</a>
<HR WIDTH=100%>
　<BR>
<A HREF="index.htm">メニューへ戻る</A> 
<HR WIDTH=100%> 
<p>
<b><a name="140">問14</a>　</b>　　（解説は省略します。）</p>
<hr> 
<p><b><a name="141">設問</a>1　</b></p> 
<p>＜解答＞　ア<br>
　</p> 
<HR WIDTH=100%> 
<a HREF="12s_p_e4.htm#141">問題へ</a> 
<HR WIDTH=100%> 
<p><b><a name="142">設問</a>2　</b></p> 
<p>＜解答＞　エ</p>
<HR WIDTH=100%> 
<a HREF="12s_p_e4.htm#142">問題へ</a> 
<hr> 
<p><b><a name="143">設問</a>3　</b></p> 
<p>＜解答＞　イ</p>
<HR WIDTH=100%> 
<a HREF="12s_p_e4.htm#143">問題へ</a> 
<HR WIDTH=100%> 
<p><b><a name="144">設問</a>4　</b></p> 
<p>＜解答＞　イ</p>
<HR WIDTH=100%> 
<a HREF="12s_p_e4.htm#144">問題へ</a> 
<HR WIDTH=100%> 
<p> 
<A HREF="index.htm">メニューへ戻る</A></p> 
<HR WIDTH=100%> 
<p><BR> 
</p> 
  <p>　</p>
</blockquote>
</BODY> 
</HTML> 
