<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<meta http-equiv="Content-Language" content="ja">
<TITLE>平成14年度秋期試験　(問3〜問5)</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" topmargin="0" leftmargin="0">
<blockquote>
  <hr>
  <H3 align="center">平成14年度秋期試験　正解例と解説(問3〜問5)</H3>
<HR WIDTH=100%>
<A NAME="30">　<BR>
<b>
問3</b></a><b>　</b>

<HR>
<A NAME="31">　<BR>
<b>
設問1</b></a>
＜解答＞　a　イ　　　b　エ<br>
<br>＜解説＞受注表は受注伝票のヘッダ情報に相当し，その受注番号の受注がどの顧客番号の顧客からのものかを表す表であるので，空欄aは顧客番号に該当する。受注明細表は，受注伝票の明細部に相当し，その受注番号ごと，品番ごとの商品の受注数量の明細を表す表であり，空欄bは数量に該当する。<br>
｛　｝で繰返し部分を表すと，受注伝票の項目は以下のように表せる。<br>
　　　受注伝票（受注番号，顧客番号，顧客名，日付，｛品番，品名，単価，数量｝）<br>
<br>
これを正規化すると，以下のようになる。<br>
　　　受注表（受注番号，顧客番号，日付）<br>
　　　受注明細（受注番号，品番，数量）<br>
　　　顧客表（顧客番号，顧客名）<br>
　　　商品表（品番，品名，単価）<br>
<br>
<HR WIDTH=100%>

<A HREF="14F_P_E2.HTM#31">問題へ</A>
<HR WIDTH=100%>
<A NAME="32">　<BR>
<b>
設問2</b></a>　　
＜解答＞　c　エ　　　d　ウ　　　e　ク<br>
<br>＜解説＞SELECT文で抽出する項目は，顧客番号と顧客ごとの平均受注額であり，その抽出条件は<br>
顧客あたりの平均受注額＞受注額の平均<br>
である。したがってGROUP　BY　顧客番号の指定により顧客番号ごとにグループ集計した受注額の平均を計算する必要がある。またGROUP　BY句によるグループ集計の抽出条件の指定は，HAVINGにより指定する。受注額の平均は，SELECT　AVG（受注額）　FROM　受注額表により求まるので，HAVINGによる抽出条件は，AVG（受注額）＞（SELECT　AVG（受注額）　FROM　受注額表となる。これよりSQL文は，<br>
　　　SELECT　顧客番号，AVG（受注額）　FROM　受注額表<br>
　　　　　　GROUP　BY　顧客番号<br>
　　　　　　HAVING　AVG（受注額）＞（SELECT　AVG（受注額）　FROM　受注額表）<br>
<br>
<HR WIDTH=100%>
<A HREF="14F_P_E2.HTM#32">問題へ</A>
<HR WIDTH=100%>
<p><A HREF="INDEX.HTM">メニューへ戻る</A>　</p>
<HR WIDTH=100%>
<A NAME="40">　<BR>
<b>
問4</b></a>　
<HR WIDTH=100%>
<A NAME="41">
<b>　<BR>
設問1</b></a>
＜解答＞　a　カ　　　b　ウ<br>
<br>＜解説＞空欄aについて<br>
副プログラムGetLine( Text [ ], N, Sp, Dan, Ep )は，配列Text [ ]の文字列から 行末を探し，その位置をEpにセットして返すプログラムである。次の繰返しループの条件Sp ≦ Nは，配列Text [ ]の最後の文字Text [N]まで文字Text [Sp]を1文字ずつ編集用の2次元配列Page [Gp][Mp]にセットし，1ページごとに副プログラムPageOut ( Page [ ][ ], Gyo, (Moji + Yohaku) )により印字する繰返しループにおける繰返条件である。空欄aを含む繰返しループの直後で，編集用の2次元配列Page [Gp][Mp]の文字位置MpをYhaku＋1に初期化し，行位置Gyoを＋1して改行している。したがって空欄aの繰返し条件は，行末Epになるまで配列の文字Text [Sp]を編集用の2次元配列Page [Gp][Mp]に転送し1行分を編集する処理の繰返し条件になっている。行末位置はEpなので空欄aは，Sp≦Epとなる。行位置Gpが出力行数Gyoを越えれば，副プログラムPageOut ( Page [ ][ ], Gyo, (Moji + Yohaku) )により印字する。<br>
<br>
空欄bについて<br>
副プログラムGetLine( Text [ ], N, Sp, Moji, Ep )は，配列Text [ ]の文字列から 行末を探し，その位置をEpにセットして返す。繰返しループの処理で文字列の最後の文字位置Nに達するまでの間，空欄bを含む条件が成り立つ場合，Epをカウントアップしているが，成り立たなくなればLoopにfalseをセットして繰返しループを終了している。したがって空欄bを含む条件は，行末でない条件である。行末の条件は，<img border="0" src="image/01_maru.GIF">ピリオド“．”が見つかった場合<img border="0" src="image/02_maru.GIF">開始位置SpからMoji個分の文字位置に達した場合のいずれかである。条件<img border="0" src="image/01_maru.GIF">は Text [Ep]＝“．”，条件<img border="0" src="image/02_maru.GIF">はEp≧(Sp＋Moji−1)となる。したがって行末でない条件は，Text [Ep]≠“．”かつEp＜(Sp＋Moji−1)となる。これより空欄bはEp＜(Sp＋Moji−1)となる。<br>

        <p><img border="0" src="image/FPA4-1.GIF"></p>
        <p><br>
<HR WIDTH=100%> 
<A HREF="14F_P_E2.HTM#41">問題へ</A> 
<HR WIDTH=100%> 
<A NAME="42"> 
　<BR>
<b>
設問2</b></a>
＜解答＞　c　イ　　　　d　イ　　　e　カ　　　f　イ　　　g　ウ<br>
<br>＜解説＞空欄cについて<br>
段組しない場合，1行に編集する文字数DANには1行の最大文字数Mojiをセットすればよいが，段組する場合，段組の1段に編集する文字数DANには，（1行の最大文字数−段組間隔2文字）÷2をセットする必要がある。したがって空欄cは，(Moji−2)／2となる。<br>
        <p><img border="0" src="image/FPA4-2.GIF"></p>
        <p><br>
空欄d，eについて<br>
変数Dpは，Dp＝1のとき1段目，Dp＝2のとき2段目の編集を示すフラグ変数である。空欄d，eはそれぞれ1段目の最初の1文字目の編集開始位置，2段目の最初の1文字目の編集開始位置を編集位置Mpに設定する処理に相当する。1段目の最初の1文字目の編集開始位置はYohaku＋1なので，空欄dはMp ← Yohaku＋1。また段組間隔が2文字なので，2段目の最初の1文字目の編集開始位置はYohaku＋1＋2＋DAN＝Yohaku＋DAN＋3となり，空欄eはMp ← Yohaku＋DAN＋3。<br>
<br>
空欄f，gについて<br>
処理γの出力処理プログラムPageOutは，Sp＞Nになれば実行される。つまり編集用2次元配列Page[ ]に配列Text [ ]の最後の文字までセットし終わったとき実行される。このときDp＝1であれば1段目の編集途中で，行ポインタGpをカウントアップした後，Sp＞Nとなってループを抜け，出力処理プログラムPageOutを実行することになる。したがってこの場合1段目の(Gp−1)行目まで編集用2次元配列Page[ ]に編集されていることになるので，PageOutにより(Gp−1)行目までを出力すればよい。したがって空欄fはGp−1。これに対し，Dp＝2であれば2段目の編集途中で，すでに1段目はGyo行目まで編集用2次元配列Page[ ]に編集されているので，PageOutによりGyo行目までを出力する必要がある。したがって空欄gはGyo。<br>
<br>
<HR WIDTH=100%>  

<A HREF="14F_P_E2.HTM#42">問題へ</A>  
<HR WIDTH=100%>  
<BR>
<b><a name="50">問5</a>　</b>
<hr>
<p><b><a name="51">設問1</a>　</b>
</p>
＜解答＞　a　ク<br>
<br>＜解説＞トランザクションは，在庫関連の表の利用認証をうけるため，利用許可番号をもたなければならないので，空欄aは利用許可番号に該当する。<br>
<br>
</p>
<HR WIDTH=100%>
  <a HREF="14F_P_E2.HTM#51">問題へ</a>
<HR WIDTH=100%>
  　<BR>
<b><a name="52">設問2</a>　</b>
＜解答＞　b　ア　　　c　ク　　　d　エ　　　e　オ　　　f　イ<br>
<br>＜解説＞モジュール間インタフェース<img border="0" src="image/02_maru.GIF">より，空欄bのモジュールの入力がトランザクションで，該当レコードが出力されるので，空欄bは「該当レコードの取得」。モジュール間インタフェース<img border="0" src="image/05_maru.GIF">より，空欄cのモジュールの入力が利用許可番号で，利用許可検査フラグが出力されるので，空欄cは「利用許可番号の検査」。モジュール間インタフェース<img border="0" src="image/06_maru.GIF">より，空欄dのモジュールの入力がトランザクションで，様式検査フラグが出力されるので，空欄dは「トランザクション様式の検査」。モジュール間インタフェース<img border="0" src="image/07_maru.GIF">より，空欄eのモジュールの入力がトランザクションで，部品表と入出庫表の該当レコード及び部品番号なしフラグが出力されるので，空欄eは「入出庫活動に関するレコードの処理」。モジュール間インタフェース<img border="0" src="image/08_maru.GIF">より，空欄fのモジュールの入力がトランザクションで，部品表と在庫表の該当レコード及び在庫不足フラグが出力されるので，空欄fは「在庫状況に関するレコードの処理」に該当する。<br>
<br>
<HR WIDTH=100%>
  <a HREF="14F_P_E2.HTM#52">問題へ</a>
<HR WIDTH=100%>
<p><b><a name="53">設問3</a>　</b>
</p>
＜解答＞　g　ア　　　h　ク<br>
<br>＜解説＞利用許可検査と様式検査の結果により，エラーメッセージの編集出力モジュールでは，利用許可検査フラグ，様式検査フラグに基づきエラーメッセージを編集するので，モジュールの入力としてトランザクション以外に利用許可検査フラグ，様式検査フラグが必要である。さらに部品番号の存在する部品番号フィールドについて，けた数やデータ型を検査するので，部品番号なしフラグも必要である。したがって空欄ｈは部品番号なしフラグ、様式検査フラグ、利用許可検査フラグ。<br>
エラーメッセージの編集出力モジュールの入力としてトランザクションが必要なので，その上位モジュールである出力データ作成モジュールの入力にトランザクションが必要になるが，<img border="0" src="image/03_maru.GIF">の入力にトランザクションがない。したがって<img border="0" src="image/03_maru.GIF">の空欄gはトランザクション。<br>
<br>
<HR WIDTH=100%>
<a HREF="14F_P_E2.HTM#53">問題へ</a>
<hr>
<p>
<A HREF="INDEX.HTM">メニューへ戻る</A></p>
<HR WIDTH=100%>
  <p>　</p>
</blockquote>
</BODY>
</HTML>
