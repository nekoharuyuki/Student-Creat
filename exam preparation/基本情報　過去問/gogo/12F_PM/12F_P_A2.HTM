<HTML>
<HEAD>
<TITLE>平成12年度秋期試験　問題(問3～問6)</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" topmargin="0" leftmargin="0">
<blockquote>
<hr>
<H3 align="center">平成12年度秋期試験　正解例と解説(問3～問6)</H3>
<hr>
<P>
<A NAME="30">
<b>
問3</b></a><b>　</b>
<A NAME="30">
<HR>
</a><A NAME="31">　<BR>
<b>
設問1</b></a><b>　</b>
<p>＜解答＞　ａ　ウ　　　　ｂ　イ</p>
<p>＜解説＞　値渡し（値呼出し）の場合は、メインプログラムの実引数からサブプログラムの仮引数に値だけが引き渡されてコピーされる。その場合、メインプログラムの実引数とサブプログラムの対応する仮引数とは別の記憶領域が確保されるので、サブプログラム側で仮引数の内容を変更しても、メインプログラムの実引数の内容は変更されない。<br>
　これに対し参照渡し（参照呼出し）の場合は、メインプログラムの実引数のアドレスがサブプログラムの仮引数のアドレスとして引き渡され、この同じアドレスの記憶領域を用いて処理される。したがってこの場合サブプログラム側で仮引数の内容を変更すると、メインプログラムの実引数の内容が変更される。<br>
<br>
　Call B (X1)は、変数X1を実引数として、手続きBを呼出し、引数は参照渡しである。参照渡しであるため、実引数X1のアドレスを仮引数X2のアドレスとして引き渡し（参照渡し）、戻り番地をスタックアドレスにプッシュして手続きBに分岐する。手続きBが呼び出される直前のスタックの内容は図3のようになっているので、実引数X1のアドレスを仮引数X2のアドレスとして引き渡す場合、</p>   
<table border="0" cellpadding="3" cellspacing="0">   
  <tr>   
    <td valign="top">①</td>   
    <td>先ず実引数X1の値をスタックにプッシュし、スタックアドレスを－1する<br>   
      　（高い番地のアドレスから低い番地のアドレスにスタックにプッシュされるのでプッシュするごとにスタックアドレスを－1する）</td>
  </tr>
  <tr>
    <td valign="top">②</td>
    <td>実引数X1の値の格納先アドレスをスタックにプッシュし、スタックアドレスを－1する</td>
  </tr>
  <tr>
    <td valign="top">③</td>
    <td>戻り番地をスタックにプッシュし、手続きBに分岐する</td>
  </tr>
</table>
<p>順にスタックに引数のアドレスと値がプッシュされることになる。<br>
<br>
図1のαで示す手続きBの呼び出し直前における変数への代入X1＝100から、図2のβで示す手続きCが呼び出される直前までの処理は以下のようになる。</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td valign="top">①</td>
    <td>変数X1に値100を代入</td>
  </tr>
  <tr>
    <td valign="top">②</td>
    <td>X1の値100をスタックアドレスγの領域にプッシュ</td>
  </tr>
  <tr>
    <td valign="top">③</td>
    <td>X1の値の格納アドレスをスタックアドレス(γ－1)の領域にプッシュ</td>
  </tr>
  <tr>
    <td valign="top">④</td>
    <td>実引数X1のアドレスγを仮引数X2のアドレスとして引き渡し（参照渡し）、戻り番地をスタックアドレス(γ－2)にプッシュして手続きBに分岐する</td>
  </tr>
  <tr>
    <td valign="top">⑤</td>
    <td>仮引数X2は、アドレスγの値100を参照</td>
  </tr>
  <tr>
    <td valign="top">⑥</td>
    <td>手続きBの中で定義された局所変数X1にX2の値100を代入</td>
  </tr>
  <tr>
    <td valign="top">⑦</td>
    <td>手続きBの中のこの局所変数X1は、実引数X1とは全く別の変数として定義されたものである。したがってX2よりこの局所変数X1に代入される値100は、スタックアドレス(γ－3)に格納され、その格納先アドレスがスタックアドレス(γ－4)にプッシュされる。</td>
  </tr>
  <tr>
    <td valign="top">⑧</td>
    <td>アドレスγにおける仮引数X2の値に200を代入<br>
      （これにより同じアドレスを参照する手続きBの実引数X1の値が、参照渡しであるため200に変更されてしまう）<br>
      したがって空欄aはウ、空欄bはイが正解となる。
      <p><img border="0" src="image/A12a03f1.gif" width="686" height="186"></td>
  </tr>
  <tr>
    <td valign="top">⑨</td>
    <td>すでにX1の格納先アドレスγ－3が、スタックアドレスγ－4にプッシュされているので、戻り番地をアドレスγ－5にプッシュし、X1を実引数として手続きCに分岐する。</td>
  </tr>
</table>
<p>　</p>
<HR WIDTH=100%>
<a HREF="12f_p_e2.htm#31">問題へ</a>
<HR WIDTH=100%>
<A NAME="32">　<BR>
<b>
設問2</b></a>　　
<p>＜解答＞　ア、　エ、　キ</p>
<p>＜解説＞Extern 手続き名で外部関数宣言された手続きやExtern 大域変数名で外部変数宣言された大域変数は、別のモジュール（別のコンパイル単位）内にある手続きをリンクし呼び出すことができ、リンクにより外部参照が解決できる。<br>   
　これに対し、局所変数や内部手続きは、コンパイル時点でその手続き内部で参照が解決でき、リンク前に既に参照は解決済みである。したがって</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td valign="top">ア</td>
    <td>手続きＡに対し手続きBは外部関数宣言されており、リンク時に解決できる。</td>
  </tr>
  <tr>
    <td valign="top">イ</td>
    <td>変数X1は、局所変数であるため、リンク前のコンパイル時に解決済みである。</td>
  </tr>
  <tr>
    <td valign="top">ウ</td>
    <td>手続きCは、手続きBの内部手続きであるため、リンク前のコンパイル時に参照が解決済みである。</td>
  </tr>
  <tr>
    <td valign="top">エ</td>
    <td>変数Sは、手続きBの外側で外部変数宣言された大域変数であり、リンク時に参照が解決できる。</td>
  </tr>
  <tr>
    <td valign="top">オ</td>
    <td>手続きBにおける変数X1は、手続きB内で宣言された局所変数であるため、リンク前のコンパイル時に参照が解決済みである。</td>
  </tr>
  <tr>
    <td valign="top">カ</td>
    <td>手続きBにおける変数X2は、手続きB内で宣言された局所変数であるため、リンク前のコンパイル時に参照が解決済みである。</td>
  </tr>
  <tr>
    <td valign="top">キ</td>
    <td>変数Sは、手続きCの外側で外部変数宣言された大域変数であり、リンク時に参照が解決できる。</td>
  </tr>
</table>
<p>　</p>
<HR WIDTH=100%>
<a HREF="12f_p_e2.htm#32">問題へ</a>
<HR WIDTH=100%>
<p><A HREF="index.htm">メニューへ戻る</A>　</p>
<HR WIDTH=100%>
<A NAME="40">　<BR>
<b>
問4</b></a>　
<HR WIDTH=100%>
<A NAME="41">
<b>　<BR>
設問</b></a>
<p>＜解答＞ａ　カ　　ｂ　イ　　ｃ　エ　　ｄ　エ　　ｅ　ケ</p>
<p>＜解説＞<br>
空欄ａ<br>
　レコード数は99件以下であり，最大99件までは成績表［1］から成績表［99］に格納される。入力件数＝100になれば，“入力件数が上限を超えた”を印字して終了する必要があります。したがって空欄ａは100になります。</p>
<p>空欄ｂ<br>
　あるｊの値に対してｋ＝空欄ｂの値からｋ≦入力件数－1である間，ｋの値を＋1ずつ変えて合計［ｊ］と合計［ｋ］を比較する処理を繰り返しています。比較するのは合計［ｊ］の直後から開始すればよいのでｋ＝ｊ+1となります。したがって空欄ｂはｊ+1になります。</p>
<p>空欄ｃ<br>
　成績の合計点の良い順，つまり降順に印字すします。したがってあるｊの値に対してｋ＝ｊ+1からｋ≦入力件数－1である間，ｋの値を＋1ずつ変えて合計［ｊ］と合計［ｋ］を比較した結果，合計［ｊ］＜合計［ｋ］となり並び順が逆転したときに成績表［ｊ］と成績表［ｋ］の入替えを行えばよい。したがって空欄ｃは“＜”となります。</p>
<p>空欄ｄ<br>
　さらに成績の合計点が同じ場合は，国語の点の良い順に印字します。したがって合計［ｊ］＝合計［ｋ］である場合，成績表［ｊ］・国語＜成績表［ｋ］・国語となり並び順が逆転したときに成績表［ｊ］と成績表［ｋ］の入替えを行えばよい。したがって空欄ｄは“＜”となります。</p>
<p>空欄ｅ<br>
　入力件数分のレコードを印字すればよいので，ｊを1～入力件数まで変えて印字します。空欄ｅはｊの終了条件であるのでｊ≦入力件数となります。したがって空欄ｅは入力件数とすればよい。<br>
</p>
<HR WIDTH=100%>
<a HREF="12f_p_e2.htm#41">問題へ</a>
<HR WIDTH=100%>
<A HREF="index.htm">メニューへ戻る</A>　 
<HR WIDTH=100%> 
　<BR>
<b><a name="50">問5</a>　</b>
<hr>
<p><b><a name="51">設問1</a>　</b>
</p>
<p>＜解答＞　　　エ
</p>
<p>＜解説＞
</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td valign="top">①</td>
    <td> 注文表は顧客コードに対する受注番号の対応関係を示す表で、同一の顧客に対し複数の受注が発生するケースがあることを示している。</td>
  </tr>
  <tr>
    <td valign="top">②</td>
    <td> 受注明細表は受注番号に対する商品番号の対応関係を示す表で、同一の受注に対し複数の受注商品が発生するケースがあることを示している。</td>
  </tr>
</table>
<p>　受注番号、顧客名、受注金額の３項目からなる設問の表は、顧客ごとに受注番号別に受注金額をグループ集計することにより得られる表である。<br>
　ところがSQL文の例では、
</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td>①</td>
    <td> 注文表と顧客表を顧客コードをキーにして結合</td>
  </tr>
  <tr>
    <td>②</td>
    <td> 注文表と受注明細表を受注番号をキーにして結合</td>
  </tr>
  <tr>
    <td>③</td>
    <td> 受注明細表と商品表を商品番号をキーにして結合</td>
  </tr>
</table>
<p>してはいるが、GROUP　BY句によりグループ集計のキー項目である受注番号、顧客名の指定がないので、受注番号、顧客名、商品番号ごとにそのまま結合されるだけで、SUM（注文数量＊単価）により合計を指定しても、受注金額のグループ別合計がされない。グループ集計により上記の表を得るには、GROUP　BY句により、受注番号、顧客名の指定を追加する必要がある。<br>
<br>
　アは誤り。１つのSELECT文で最大15個までの表が結合できる。<br>
　イも誤り。複数の表を結合した結果に対し、SUM関数を使って集計できる。ただし関数は、WHERE句の中で直接条件に指定して使用することができない。<br>
　ウは誤りで、エが適切。上記の理由により、顧客ごとに受注番号別に受注金額をグループ集計する必要がある。<br>
　オは不適切。ORDER　BY句は、キー項目の順に並べ替えを行うための指定である。<br>
<br>
</p>
<HR WIDTH=100%>
<a HREF="12f_p_e2.htm#51">問題へ</a>
<HR WIDTH=100%>
<p><b><a name="52">設問2</a>　</b></p>
<p>＜解答＞　ａ　キ　　　　ｂ　エ　　　　ｃ　ア
</p>
<p>＜解説＞（1）について<br>
空欄a最初のSQL文の
</p>
<p>SELECT   商品番号 FROM 注文表, 受注明細表<br>  
   WHERE 顧客コード = 'A156' AND 注文表.受注番号 = 受注明細表.受注番号  
</p>  
<p>は、注文表と受注明細表とを受注番号をキーにして結合し、顧客コードが 'A156'の顧客から受注した商品の商品番号を抽出するSQL文である。これにより抽出された結果が表１である。この受注した商品の商品番号の一覧に対して、更に商品表を商品番号をキーにして結合し、品種を抽出するためにSQL文①が実行されている。これはM：Nのマッチングで受注した商品の表1の10個の商品番号に対し、商品表の該当する商品番号の行がそのまま結合されて10個の品種のデータが抽出される。  
</p>  
<table border="0" cellpadding="5" cellspacing="0"> 
  <tr> 
    <td> 
      <table border="1" cellpadding="3" cellspacing="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" bordercolor="#FFFFFF"> 
        <tr> 
          <td>商品番号</td> 
        </tr> 
        <tr> 
          <td>400</td> 
        </tr> 
        <tr> 
          <td>401</td> 
        </tr> 
        <tr> 
          <td>500</td> 
        </tr> 
        <tr> 
          <td>300</td> 
        </tr> 
        <tr> 
          <td>301</td> 
        </tr> 
        <tr> 
          <td>302</td> 
        </tr> 
        <tr> 
          <td>700</td> 
        </tr> 
        <tr> 
          <td>300</td> 
        </tr> 
        <tr> 
          <td>300</td> 
        </tr> 
        <tr> 
          <td>301</td> 
        </tr> 
      </table> 
    </td> 
    <td> 
      <table border="1" cellpadding="3" cellspacing="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" bordercolor="#FFFFFF"> 
        <tr> 
          <td>商品番号</td> 
          <td>品種</td> 
        </tr> 
        <tr> 
          <td>300</td> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>301</td> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>302</td> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>400</td> 
          <td>ＶＴＲ</td> 
        </tr> 
        <tr> 
          <td>401</td> 
          <td>ＶＴＲ</td> 
        </tr> 
        <tr> 
          <td>500</td> 
          <td>DVDプレーヤ</td> 
        </tr> 
        <tr> 
          <td>501</td> 
          <td>DVDプレーヤ</td> 
        </tr> 
        <tr> 
          <td>600</td> 
          <td>CDラジカセ</td> 
        </tr> 
        <tr> 
          <td>601</td> 
          <td>CDラジカセ</td> 
        </tr> 
        <tr> 
          <td>700</td> 
          <td>MDコンポ</td> 
        </tr> 
      </table> 
    </td> 
    <td><font size="4">⇒</font></td> 
    <td> 
      <table border="1" cellpadding="3" cellspacing="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" bordercolor="#FFFFFF"> 
        <tr> 
          <td>品種</td> 
        </tr> 
        <tr> 
          <td>ＶＴＲ</td> 
        </tr> 
        <tr> 
          <td>ＶＴＲ</td> 
        </tr> 
        <tr> 
          <td>DVDプレーヤ</td> 
        </tr> 
        <tr> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>MDコンポ</td> 
        </tr> 
        <tr> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>テレビ</td> 
        </tr> 
        <tr> 
          <td>テレビ</td> 
        </tr> 
      </table> 
    </td> 
  </tr> 
</table> 
<p>空欄b<br> 
SQL文②のIN以下の副検索によるSELECT文で表1の10件の商品番号が抽出されるので、SQL文②は以下のSQL文と等価になる。<br> 
　SELECT　品種 FROM 商品表 WHERE 商品表.商品番号<br>  
　　　　IN（400，401，500，300，301，302，700，300，300，301）<br>
したがって商品番号が400，401，500，300，301，302，700，300，300，301のいずれか、つまり400，401，500，300，301，302，700のいずれかに一致する<br>
行の品種が抽出される。商品表にはこの7つの商品番号に関する行がすべて存在するので、以下の7つの品種に関する行が抽出される。<br>
<br>
</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td>
      <table border="1" cellpadding="3" cellspacing="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" bordercolor="#FFFFFF">
        <tr>
          <td>商品番号</td>
        </tr>
        <tr>
          <td>400</td>
        </tr>
        <tr>
          <td>401</td>
        </tr>
        <tr>
          <td>500</td>
        </tr>
        <tr>
          <td>300</td>
        </tr>
        <tr>
          <td>301</td>
        </tr>
        <tr>
          <td>302</td>
        </tr>
        <tr>
          <td>700</td>
        </tr>
      </table>
    </td>
    <td><font size="4">⇒</font></td>
    <td>
      <table border="1" cellpadding="3" cellspacing="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" bordercolor="#FFFFFF">
        <tr>
          <td>品種</td>
        </tr>
        <tr>
          <td>ＶＴＲ</td>
        </tr>
        <tr>
          <td>ＶＴＲ</td>
        </tr>
        <tr>
          <td>DVDプレーヤ</td>
        </tr>
        <tr>
          <td>テレビ</td>
        </tr>
        <tr>
          <td>テレビ</td>
        </tr>
        <tr>
          <td>テレビ</td>
        </tr>
        <tr>
          <td>MDコンポ</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<p>空欄c<br>
SQL文②で品種にDISTINCTを指定すると、同一の品種を1つと数えて重複をせずに抽出するので、右の4つの行が抽出される。
</p>
<table border="1" cellpadding="3" cellspacing="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" bordercolor="#FFFFFF">
  <tr>
    <td>品種</td>
  </tr>
  <tr>
    <td>ＶＴＲ</td>
  </tr>
  <tr>
    <td>DVDプレーヤ</td>
  </tr>
  <tr>
    <td>テレビ</td>
  </tr>
  <tr>
    <td>MDコンポ</td>
  </tr>
</table>
<p>　</p>
<HR WIDTH=100%>
<a HREF="12f_p_e2.htm#52">問題へ</a>
<hr>
<p>
<A HREF="index.htm">メニューへ戻る</A></p>
<HR WIDTH=100%>
<p><b><a name="60">問6</a>　</b>
</p>
<hr>
<p><b><a name="61">設問1</a>　</b></p>
<p>＜解答＞ａ　キ　　　ｂ　ウ　　　ｃ　ケ　　　ｄ　ケ</p>
<p>＜解説＞　このコンピュータネットワークでは、関門ルータ内の設定テーブルで指定されたＩＰ層のＩＰアドレスとＴＣＰ層のポート番号の組み合わせによりパケットフィルタリングを行い、該当するパケットだけを通過させるアクセス制御を行っている。</p>
<table border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td valign="top">①</td>
    <td>表１の設定テーブルの条件１における送信元IPアドレス100.1.1.1～100.1.1.5は、Ｘ社内のコンピュータPC-NA～PC-NEのIPアドレスである。したがって条件１は社内から社外へのあて先ポート番号23のtelnetサービスによるパケットを通過許可する設定である。</td>
  </tr>
  <tr>
    <td valign="top">②</td>
    <td>表１の設定テーブルの条件２では、このＸ社内のコンピュータPC-NA～PC-NEのIPアドレス100.1.1.1～100.1.1.5があて先アドレスとなっている。したがって条件２は、送信元ポート番号23のtelnetサービスによる社外から社内への返信のパケットを通過許可する設定である。</td>
  </tr>
</table>
<p>設問の空欄a、b、cについて<br>
　社外のＹ社の２台のパソコン（IPアドレス101.1.1.1と101.1.1.2）を送信元として、あて先であるＸ社のデータ転送用サーバ（IPアドレス100.1.1.12）に、ポート番号1024と1025を利用して接続する。<br>
したがって表２の設定テーブル（１行目）は以下のように設定すればよい。</p>
<p>空欄aの送信元アドレスの設定は101.1.1.1：101.1.1.2<br>
空欄bのあて先アドレスの設定は100.1.1.12<br>
空欄cのあて先ポート番号の設定は1024：1025</p>
<p>設問の空欄dについて<br>
　逆にＸ社のサーバからＹ社のパソコンへの返信のパケットを通過許可するために、Ｘ社のデータ転送用サーバ（IPアドレス100.1.1.12）を送信元として、あて先であるＹ社の２台のパソコン（IPアドレス101.1.1.1と101.1.1.2）に接続できるように設定を行う。このときＸ社のサーバは送信元ポート番号の1024と1025を利用する。<br>
したがって表２の設定テーブル（２行目）は以下のように設定すればよい。</p>
<p>空欄aのあて先アドレスの設定は101.1.1.1：101.1.1.2<br>
空欄bの送信元アドレスの設定は100.1.1.12<br>
空欄dの送信元ポート番号の設定は1024：1025<br>
</p>
<HR WIDTH=100%>
<a HREF="12f_p_e2.htm#61">問題へ</a>
<HR WIDTH=100%>
<A HREF="index.htm">メニューへ戻る
</A>
<HR WIDTH=100%>
<p>　</p>
  </blockquote>
</BODY>
</HTML>
